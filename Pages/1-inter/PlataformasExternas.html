<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Integración con Plataformas Externas - ITS Jerez</title>
  <!-- Bootstrap CSS -->
  <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f8f9fa;
    }
    .main-content {
      margin-top: 20px;
    }
    .integracion-desactivada {
      color: gray;
    }
    .integracion-activada {
      color: green;
    }
  </style>
  <script src="https://apis.google.com/js/api.js"></script>
  <script>
    function handleClientLoad() {
      gapi.load('client:auth2', initClient);
    }
  
    function initClient() {
      gapi.client.init({
        apiKey: 'YOUR_API_KEY',  // Reemplaza con tu API Key
        clientId: 'YOUR_CLIENT_ID.apps.googleusercontent.com',  // Reemplaza con tu Client ID
        scope: 'https://www.googleapis.com/auth/drive.file'
      }).then(() => {
        document.getElementById('botonGoogleDrive').onclick = handleAuthClick;
        document.getElementById('botonDesconectarGoogleDrive').onclick = handleSignoutClick;
      });
    }
  
    function handleAuthClick() {
      gapi.auth2.getAuthInstance().signIn().then(() => {
        // Actualiza el estado de Google Drive como conectado
        googleDriveConectado = true;
        actualizarEstadoGoogleDrive();
      });
    }
  
    function handleSignoutClick() {
      gapi.auth2.getAuthInstance().signOut().then(() => {
        googleDriveConectado = false;
        actualizarEstadoGoogleDrive();
      });
    }
  
    // Cargar la API de Google
    gapi.load('client:auth2', handleClientLoad);
  </script>
  
</head>
<body>

<div class="container">
  <h1 class="mt-4">Integración con Plataformas Externas</h1>
  <p>Configura la integración con Google Drive y WhatsApp para mejorar la gestión de tus tutorías.</p>

  <!-- Integración con Google Drive -->
  <div class="card mb-4">
    <div class="card-body">
      <h5 class="card-title">Integración con Google Drive</h5>
      <p>Conecta una cuenta de Google Drive para almacenar y compartir documentos de las tutorías.</p>
      <button id="botonGoogleDrive" class="btn btn-primary">Conectar Google Drive</button>
      <button id="botonDesconectarGoogleDrive" class="btn btn-danger d-none">Desconectar Google Drive</button>
      <p id="estadoGoogleDrive" class="integracion-desactivada">Estado: No conectado</p>
    </div>
  </div>

  <!-- Integración con WhatsApp -->
  <div class="card mb-4">
    <div class="card-body">
      <h5 class="card-title">Integración con WhatsApp</h5>
      <p>Permite configurar un enlace directo para comunicarte con estudiantes y tutores a través de WhatsApp.</p>
      <form id="formWhatsApp">
        <div class="form-group">
          <label for="numeroWhatsApp">Número de WhatsApp</label>
          <input type="tel" class="form-control" id="numeroWhatsApp" placeholder="+521234567890" required>
        </div>
        <div class="form-group">
          <label for="mensajeInicial">Mensaje Inicial</label>
          <input type="text" class="form-control" id="mensajeInicial" placeholder="Escribe tu mensaje de bienvenida" required>
        </div>
        <button type="submit" class="btn btn-primary">Generar Enlace</button>
      </form>
      <p id="estadoWhatsApp" class="mt-3">Estado: No configurado</p>
      <p id="enlaceWhatsApp" class="integracion-activada d-none">Enlace generado: <a href="#" target="_blank" id="linkWhatsApp">Abrir en WhatsApp</a></p>
    </div>
  </div>
</div>

<!-- Bootstrap JS -->
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

<!-- Script para manejar integraciones -->
<script>
  // Estado de integración con Google Drive (simulado)
  let googleDriveConectado = false;

  // Función para conectar con Google Drive (simulado)
  document.getElementById('botonGoogleDrive').addEventListener('click', function() {
    googleDriveConectado = true;
    actualizarEstadoGoogleDrive();
  });

  // Función para desconectar Google Drive (simulado)
  document.getElementById('botonDesconectarGoogleDrive').addEventListener('click', function() {
    googleDriveConectado = false;
    actualizarEstadoGoogleDrive();
  });

  // Actualizar el estado de la integración con Google Drive
  function actualizarEstadoGoogleDrive() {
    const estado = document.getElementById('estadoGoogleDrive');
    const botonConectar = document.getElementById('botonGoogleDrive');
    const botonDesconectar = document.getElementById('botonDesconectarGoogleDrive');

    if (googleDriveConectado) {
      estado.textContent = 'Estado: Conectado';
      estado.classList.replace('integracion-desactivada', 'integracion-activada');
      botonConectar.classList.add('d-none');
      botonDesconectar.classList.remove('d-none');
    } else {
      estado.textContent = 'Estado: No conectado';
      estado.classList.replace('integracion-activada', 'integracion-desactivada');
      botonConectar.classList.remove('d-none');
      botonDesconectar.classList.add('d-none');
    }
  }

  // Función para configurar el enlace de WhatsApp
  document.getElementById('formWhatsApp').addEventListener('submit', function(e) {
    e.preventDefault();

    const numero = document.getElementById('numeroWhatsApp').value;
    const mensaje = encodeURIComponent(document.getElementById('mensajeInicial').value);
    const enlace = `https://wa.me/${numero}?text=${mensaje}`;

    const estadoWhatsApp = document.getElementById('estadoWhatsApp');
    const enlaceWhatsApp = document.getElementById('enlaceWhatsApp');
    const linkWhatsApp = document.getElementById('linkWhatsApp');

    linkWhatsApp.href = enlace;
    enlaceWhatsApp.classList.remove('d-none');
    estadoWhatsApp.textContent = 'Estado: Configurado';
  });
</script>

</body>
</html>
